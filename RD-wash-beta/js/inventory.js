"use strict";(self.webpackChunkrd_wash_001=self.webpackChunkrd_wash_001||[]).push([[525],{95:(e,t,r)=>{r.r(t),r.d(t,{codeExists:()=>ae,initInventoryPage:()=>te});var n=r(980),o=r(467),a=r(756),i=r.n(a),c=r(284),u=r(458),s=r(482),l=r(594);function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=(0,l.rJ)(s.db,"UniformsDB"),y=(0,l.rJ)(s.db,"InventoryDB"),h=(0,l.rJ)(s.db,"EmployeesDB"),b=null;function w(){return(w=(0,o.A)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b||!Array.isArray(b)){e.next=2;break}return e.abrupt("return",b);case 2:return e.prev=2,e.next=5,(0,l.GG)(v);case 5:return t=e.sent,b=t.docs.map((function(e){return m({id:e.id},e.data())})),e.abrupt("return",b);case 10:throw e.prev=10,e.t0=e.catch(2),console.error("❌ Failed to fetch uniforms:",e.t0),b=null,e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}function x(){return(x=(0,o.A)(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return console.warn("⚠️ fetchUniformById: No ID provided"),e.abrupt("return",null);case 3:return e.prev=3,e.next=6,(0,l.x7)((0,l.H9)(v,t));case 6:return r=e.sent,e.abrupt("return",r.exists()?m({id:r.id},r.data()):null);case 10:return e.prev=10,e.t0=e.catch(3),console.error("❌ fetchUniformById error:",e.t0),e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))).apply(this,arguments)}function g(){return(g=(0,o.A)(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return console.warn("⚠️ fetchEmployeeById: Employee ID not provided"),e.abrupt("return",null);case 3:return e.prev=3,e.next=6,(0,l.x7)((0,l.H9)(h,t));case 6:return r=e.sent,e.abrupt("return",r.exists()?m({id:r.id},r.data()):null);case 10:return e.prev=10,e.t0=e.catch(3),console.error("❌ fetchEmployeeById error:",e.t0),e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))).apply(this,arguments)}function C(){return(C=(0,o.A)(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null==t?void 0:t.trim().toUpperCase()){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,(0,l.GG)((0,l.P)(y,(0,l._M)("UniformCode","==",r)));case 5:return n=e.sent,e.abrupt("return",!n.empty);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){return(U=(0,o.A)(i().mark((function e(t){var r,n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===(r=t.UniformCode)||void 0===r?void 0:r.trim().toUpperCase()){e.next=3;break}throw new Error("Missing UniformCode");case 3:if(t.UniformID&&t.UniformType&&t.UniformSize&&t.UniformColor){e.next=5;break}throw new Error("Missing base uniform info");case 5:return o={UniformID:t.UniformID,UniformType:t.UniformType,UniformSize:t.UniformSize,UniformColor:t.UniformColor,UniformCode:n,UniformQty:t.UniformQty||1,img:t.img||"",EmployeeID:t.EmployeeID||"",EmployeeName:t.EmployeeName||"",EmployeDepartment:t.EmployeDepartment||"",Status:t.Status||"available",RewashCount:"number"==typeof t.RewashCount?t.RewashCount:0},e.next=8,(0,l.BN)((0,l.H9)(y,n),o,{merge:!0});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=(0,o.A)(i().mark((function e(t,r){var n,o,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null==t?void 0:t.trim().toUpperCase()){e.next=3;break}throw new Error("Missing uniform code");case 3:return e.next=5,(0,l.GG)((0,l.P)(y,(0,l._M)("UniformCode","==",n),(0,l._M)("Status","==","available")));case 5:if(!(o=e.sent).empty){e.next=8;break}throw new Error("This code is either not found or already assigned.");case 8:return a=o.docs[0].ref,e.next=11,(0,l.mZ)(a,{Status:"assigned",EmployeeID:r.employeeId,EmployeeName:r.employeeName,EmployeDepartment:r.employeeDept});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=(0,o.A)(i().mark((function e(t){var r,n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null==t?void 0:t.trim().toUpperCase()){e.next=3;break}throw new Error("Invalid uniform code");case 3:return e.next=5,(0,l.GG)((0,l.P)(y,(0,l._M)("UniformCode","==",r),(0,l._M)("Status","==","assigned")));case 5:if(!(n=e.sent).empty){e.next=8;break}throw new Error("Code not found or not currently assigned.");case 8:return o=n.docs[0].ref,e.next=11,(0,l.mZ)(o,{Status:"available",EmployeeID:"",EmployeeName:"",EmployeDepartment:""});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=(0,o.A)(i().mark((function e(t){var r,n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null==t?void 0:t.trim().toUpperCase()){e.next=3;break}throw new Error("Invalid uniform code");case 3:return e.next=5,(0,l.GG)((0,l.P)(y,(0,l._M)("UniformCode","==",r)));case 5:if(!(n=e.sent).empty){e.next=8;break}throw new Error("Uniform code not found in the system.");case 8:return o=n.docs.map((function(e){return(0,l.kd)(e.ref)})),e.next=11,Promise.all(o);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return A=(0,o.A)(i().mark((function e(t){var r,n,o,a,u=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>1&&void 0!==u[1]?u[1]:{},n=null==t?void 0:t.trim().toUpperCase()){e.next=4;break}throw new Error("Invalid Uniform Code");case 4:if("object"===(0,c.A)(r)&&!Array.isArray(r)){e.next=6;break}throw new Error("Invalid payload: must be an object");case 6:return e.next=8,(0,l.GG)((0,l.P)(y,(0,l._M)("UniformCode","==",n)));case 8:if(!(o=e.sent).empty){e.next=11;break}throw new Error("Uniform code not found in the system.");case 11:return a=o.docs.map((function(e){return(0,l.mZ)(e.ref,r)})),e.next=14,Promise.all(a);case 14:case"end":return e.stop()}}),e)}))),A.apply(this,arguments)}function S(){return(S=(0,o.A)(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null==t?void 0:t.trim()){e.next=3;break}return e.abrupt("return",[]);case 3:return e.prev=3,e.next=6,(0,l.GG)((0,l.P)(y,(0,l._M)("UniformID","==",r)));case 6:return n=e.sent,e.abrupt("return",n.docs.map((function(e){return m({id:e.id},e.data())})));case 10:return e.prev=10,e.t0=e.catch(3),console.error("❌ getAllCodesByUniformID error:",e.t0),e.abrupt("return",[]);case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))).apply(this,arguments)}function D(){return(D=(0,o.A)(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null==t?void 0:t.trim()){e.next=3;break}return e.abrupt("return",0);case 3:return e.prev=3,e.next=6,(0,l.GG)((0,l.P)(y,(0,l._M)("UniformID","==",r)));case 6:return n=e.sent,e.abrupt("return",n.size);case 10:return e.prev=10,e.t0=e.catch(3),console.error("❌ getUniformCodeCountById error:",e.t0),e.abrupt("return",0);case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))).apply(this,arguments)}function B(){return(B=(0,o.A)(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=(0,l.H9)(s.db,"Stats","InventorySummary"),e.next=4,(0,l.x7)(t);case 4:if((r=e.sent).exists()){e.next=8;break}return console.warn("⚠️ Inventory summary not found."),e.abrupt("return",{total:0,assigned:0,available:0});case 8:return e.abrupt("return",r.data());case 11:return e.prev=11,e.t0=e.catch(0),console.error("❌ Failed to get inventory summary:",e.t0),e.abrupt("return",{total:0,assigned:0,available:0});case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function M(){return(M=(0,o.A)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,l.GG)(y);case 3:return t=e.sent,e.abrupt("return",t.docs.map((function(e){return e.data()})));case 7:return e.prev=7,e.t0=e.catch(0),console.error("❌ Export Error:",e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function L(){return(L=(0,o.A)(i().mark((function e(t){var r,n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null==t?void 0:t.trim().toUpperCase()){e.next=3;break}return e.abrupt("return",null);case 3:return e.prev=3,n=(0,l.P)(y,(0,l._M)("UniformCode","==",r)),e.next=7,(0,l.GG)(n);case 7:return o=e.sent,e.abrupt("return",o.empty?null:o.docs[0].data().UniformID);case 11:return e.prev=11,e.t0=e.catch(3),console.error("❌ getUniformIdByCode Error:",e.t0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[3,11]])})))).apply(this,arguments)}var T={clearUniformCache:function(){b=null},fetchUniforms:function(){return w.apply(this,arguments)},fetchUniformById:function(e){return x.apply(this,arguments)},fetchEmployeeById:function(e){return g.apply(this,arguments)},validateUniformCode:function(e){return C.apply(this,arguments)},assignUniformToEmployee:function(e){return U.apply(this,arguments)},assignFromAvailableCode:function(e,t){return E.apply(this,arguments)},returnUniform:function(e){return I.apply(this,arguments)},deleteUniformEntry:function(e){return k.apply(this,arguments)},updateUniformCode:function(e){return A.apply(this,arguments)},getAllCodesByUniformID:function(e){return S.apply(this,arguments)},getUniformCodeCountById:function(e){return D.apply(this,arguments)},getInventorySummary:function(){return B.apply(this,arguments)},fetchAllForExport:function(){return M.apply(this,arguments)},parseCSV:function(e){var t=e.trim().split("\n"),r=t[0].split(",").map((function(e){return e.trim()}));return t.slice(1).map((function(e){var t=e.split(","),n={};return r.forEach((function(e,r){var o;return n[e]=(null===(o=t[r])||void 0===o?void 0:o.trim())||""})),n}))},exportCSV:function(e,t){var r=[t.join(",")].concat((0,u.A)(e.map((function(e){return t.map((function(t){return'"'.concat(e[t]||"",'"')})).join(",")})))).join("\n"),n=new Blob(["\ufeff"+r],{type:"text/csv;charset=utf-8;"});return URL.createObjectURL(n)},getUniformIdByCode:function(e){return L.apply(this,arguments)},getAllEmployeesAsMap:function(){return P.apply(this,arguments)},getAllUniformsAsMap:function(){return O.apply(this,arguments)},fetchUniformCodeByCode:function(e){return G.apply(this,arguments)},fetchInventoryItemsLimited:function(){return j.apply(this,arguments)},fetchInventoryItems:function(){return F.apply(this,arguments)},createInventorySummaryDoc:function(){return N.apply(this,arguments)},syncAllEmployeeDataToInventory:R};function P(){return(P=(0,o.A)(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.GG)(EmployeeDB);case 2:return t=e.sent,r={},t.docs.forEach((function(e){return r[e.id]=m({id:e.id},e.data())})),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=(0,o.A)(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.GG)(v);case 2:return t=e.sent,r={},t.docs.forEach((function(e){return r[e.id]=m({id:e.id},e.data())})),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){return(G=(0,o.A)(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,l.P)(y,(0,l._M)("UniformCode","==",t.trim().toUpperCase())),e.next=3,(0,l.GG)(r);case 3:return n=e.sent,e.abrupt("return",n.empty?null:m({id:n.docs[0].id},n.docs[0].data()));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){return j=(0,o.A)(i().mark((function e(){var t,r,n,o=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:50,r=(0,l.P)(y,(0,l.My)("UniformCode"),(0,l.AB)(t)),e.next=4,(0,l.GG)(r);case 4:return n=e.sent,e.abrupt("return",n.docs.map((function(e){return m({id:e.id},e.data())})));case 6:case"end":return e.stop()}}),e)}))),j.apply(this,arguments)}function N(){return(N=(0,o.A)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=(0,l.H9)(s.db,"Stats","InventorySummary"),e.next=4,(0,l.BN)(t,{total:0,assigned:0,available:0,updatedAt:(new Date).toISOString()});case 4:console.log("✅ InventorySummary document created."),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("❌ Failed to create InventorySummary:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function F(){return(F=(0,o.A)(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,l.GG)((0,l.P)(y,(0,l.My)("UniformType")));case 3:return t=e.sent,e.abrupt("return",t.docs.map((function(e){return m({id:e.id},e.data())})));case 7:return e.prev=7,e.t0=e.catch(0),e.next=11,(0,l.GG)(y);case 11:return r=e.sent,e.abrupt("return",r.docs.map((function(e){return m({id:e.id},e.data())})));case 13:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function R(){return z.apply(this,arguments)}function z(){return(z=(0,o.A)(i().mark((function e(){var t,r,n,o,a,c,u,s,f;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.GG)(h);case 2:return t=e.sent,r={},t.forEach((function(e){var t=e.data();r[t.employeeId]={name:t.employeeName,dept:t.employeeDept}})),e.next=7,(0,l.GG)(y);case 7:n=e.sent,o=[],a=d(n.docs);try{for(a.s();!(c=a.n()).done;)u=c.value,s=u.data(),!(f=r[s.EmployeeID])||s.EmployeeName===f.name&&s.EmployeDepartment===f.dept||o.push((0,l.mZ)(u.ref,{EmployeeName:f.name,EmployeDepartment:f.dept}))}catch(e){a.e(e)}finally{a.f()}return e.next=13,Promise.all(o);case 13:console.log("✅ Synced employee info to Inventory.");case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H=r(296);function _(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return q(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?q(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Q={currentPage:1,rowsPerPage:21,refreshAll:function(){var e=this;return(0,o.A)(i().mark((function t(){var r,n,o,a,c,u;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([T.fetchUniforms(),T.fetchInventoryItems()]);case 3:return r=t.sent,n=(0,H.A)(r,2),o=n[0],a=n[1],t.next=9,e.renderUniformBaseCards(o);case 9:return t.next=11,e.renderInventoryCards(a);case 11:t.next=20;break;case 13:t.prev=13,t.t0=t.catch(0),console.error("❌ Failed to refresh inventory data:",t.t0),c=document.getElementById("uniformBaseList"),u=document.getElementById("inventoryList"),c&&(c.innerHTML='<p style="color:red;text-align:center;">⚠️ Failed to load uniform base</p>'),u&&(u.innerHTML='<p style="color:red;text-align:center;">⚠️ Failed to load inventory</p>');case 20:case"end":return t.stop()}}),t,null,[[0,13]])})))()},reloadDetailModal:function(e){var t=this;return(0,o.A)(i().mark((function r(){var n,o;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,T.getAllCodesByUniformID(e);case 3:if(n=r.sent,o=document.getElementById("codeListBody")){r.next=7;break}return r.abrupt("return");case 7:if(o.innerHTML="",n&&0!==n.length){r.next=11;break}return o.innerHTML='\n          <tr>\n            <td colspan="6" style="text-align:center; color: #999;">🚫 No data found</td>\n          </tr>',r.abrupt("return");case 11:t.fillDetailModal(n),t.updateDetailModalHeader(n[0]),r.next=18;break;case 15:r.prev=15,r.t0=r.catch(0),console.error("❌ Error loading detail modal:",r.t0);case 18:case"end":return r.stop()}}),r,null,[[0,15]])})))()},updateDetailModalHeader:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={detailUniformId:e.UniformID,detailUniformType:e.UniformType,detailUniformSize:e.UniformSize,detailUniformColor:e.UniformColor};Object.entries(t).forEach((function(e){var t=(0,H.A)(e,2),r=t[0],n=t[1],o=document.getElementById(r);o&&(o.textContent=n||"-")}))},renderUniformBaseCards:function(){var e=arguments,t=this;return(0,o.A)(i().mark((function r(){var n,o,a,c,u,s,l,d;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.length>0&&void 0!==e[0]?e[0]:[],o=document.getElementById("uniformBaseList")){r.next=4;break}return r.abrupt("return");case 4:if(o.innerHTML="",n&&0!==n.length){r.next=8;break}return o.innerHTML='<p style="text-align:center;color:#888;">🚫 No uniform data found</p>',r.abrupt("return");case 8:a=(t.currentPage-1)*t.rowsPerPage,c=n.slice(a,a+t.rowsPerPage),u=_(c),r.prev=11,u.s();case 13:if((s=u.n()).done){r.next=21;break}return l=s.value,r.next=17,t.createUniformCard(l);case 17:d=r.sent,o.appendChild(d);case 19:r.next=13;break;case 21:r.next=26;break;case 23:r.prev=23,r.t0=r.catch(11),u.e(r.t0);case 26:return r.prev=26,u.f(),r.finish(26);case 29:t.renderPagination(n.length),t.bindUniformCardEvents(o);case 31:case"end":return r.stop()}}),r,null,[[11,23,26,29]])})))()},createUniformCard:function(e){return(0,o.A)(i().mark((function t(){var r,n,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.getUniformCodeCountById(e.uniformID);case 2:return r=t.sent,n=e.img&&e.img.startsWith("data:image"),(o=document.createElement("div")).className="inventory-card",o.innerHTML='\n      <div class="card-header"><strong>'.concat(e.uniformID,'</strong></div>\n      <div class="card-body">\n        ').concat(n?'<img src="'.concat(e.img,'" alt="Uniform" />'):'<div class="uniform-placeholder">No Picture</div>','\n        <div class="card-details-grid">\n          <p><strong>Type:</strong> ').concat(e.uniformType,"</p>\n          <p><strong>Size:</strong> ").concat(e.uniformSize,"</p>\n          <p><strong>Color:</strong> ").concat(e.uniformColor,"</p>\n          <p><strong>Qty:</strong> ").concat(r,'</p>\n        </div>\n      </div>\n      <div class="card-footer">\n        <button class="action-btn add" data-id="').concat(e.uniformID,'">➕ Add Code</button>\n        <button class="action-btn detail" data-id="').concat(e.uniformID,'">📄 Detail</button>\n      </div>\n    '),t.abrupt("return",o);case 8:case"end":return t.stop()}}),t)})))()},bindUniformCardEvents:function(e){e.querySelectorAll(".action-btn.add").forEach((function(e){e.addEventListener("click",(function(){var t=e.dataset.id;window.dispatchEvent(new CustomEvent("addCodeClick",{detail:{id:t}}))}))})),e.querySelectorAll(".action-btn.detail").forEach((function(e){e.addEventListener("click",(function(){var t=e.dataset.id;window.dispatchEvent(new CustomEvent("detailClick",{detail:{id:t}}))}))}))},renderInventoryCards:function(){var e=arguments,t=this;return(0,o.A)(i().mark((function r(){var n,o,a,c,u,s;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.length>0&&void 0!==e[0]?e[0]:[],o=document.getElementById("inventoryList")){r.next=4;break}return r.abrupt("return");case 4:if(o.innerHTML="",n&&0!==n.length){r.next=8;break}return o.innerHTML='<p style="text-align:center;color:#888;">🚫 No inventory data</p>',r.abrupt("return");case 8:a=_(n);try{for(a.s();!(c=a.n()).done;)u=c.value,s=t.createInventoryCard(u),o.appendChild(s),t.bindInventoryCardEvents(s,u)}catch(e){a.e(e)}finally{a.f()}case 10:case"end":return r.stop()}}),r)})))()},createInventoryCard:function(e){var t=document.createElement("div");return t.className="inventory-card",t.innerHTML='\n      <div class="card-header">\n        <strong contenteditable="true" onblur="updateCodeInline(this, \''.concat(e.UniformCode,"')\">").concat(e.UniformCode,'</strong>\n        <span class="badge ').concat(e.Status,'">').concat(e.Status.toUpperCase(),'</span>\n      </div>\n      <div class="card-body">\n        <p><strong>Type:</strong> ').concat(e.UniformType,"</p>\n        <p><strong>Size:</strong> ").concat(e.UniformSize,"</p>\n        <p><strong>Color:</strong> ").concat(e.UniformColor,'</p>\n        <p><strong>Employee:</strong> \n          <span contenteditable="true" onblur="updateEmployeeInline(this, \'').concat(e.UniformCode,"')\">\n            ").concat(e.EmployeeName||"-",'\n          </span>\n        </p>\n      </div>\n      <div class="card-footer">\n        ').concat("available"===e.Status?'<button class="action-btn assign">Assign</button>':'<button class="action-btn return">Return</button>','\n        <button class="action-btn delete">Delete</button>\n      </div>\n    '),t},bindInventoryCardEvents:function(e,t){var r=e.querySelector(".action-btn.assign"),n=e.querySelector(".action-btn.return"),o=e.querySelector(".action-btn.delete");r&&r.addEventListener("click",(function(){window.openAssignFromCode(t.UniformCode)})),n&&n.addEventListener("click",(function(){window.returnUniformByCode(t.UniformCode)})),o&&o.addEventListener("click",(function(){console.log("🧨 Delete clicked (inventory card):",t.UniformCode),window.confirmDeleteUniform(t.UniformCode)}))},fillDetailModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=document.getElementById("codeListBody");if(t)if(t.innerHTML="",Array.isArray(e)||(e=[e]),0!==e.length){var r,n=_(e);try{for(n.s();!(r=n.n()).done;){var o=r.value,a=this.createDetailRow(o);t.appendChild(a),this.bindDetailRowEvents(a,o)}}catch(e){n.e(e)}finally{n.f()}}else t.innerHTML='\n        <tr>\n          <td colspan="6" style="text-align:center; color: #999;">🚫 No uniform code data found</td>\n        </tr>'},createDetailRow:function(e){var t=document.createElement("tr");return t.innerHTML="\n      <td>".concat(e.UniformCode,"</td>\n      <td>").concat(e.EmployeeID||"-","</td>\n      <td>").concat(e.EmployeeName||"-","</td>\n      <td>").concat(e.EmployeDepartment||"-","</td>\n      <td>").concat(e.Status,'</td>\n      <td>\n        <div class="action-group">\n          ').concat("available"===e.Status?'<button class="action-btn assign" title="Assign">\n                  <i class="fas fa-user-plus"></i>\n                </button>':'<button class="action-btn return" title="Return">\n                  <i class="fas fa-undo-alt"></i>\n                </button>','\n          <button class="action-btn delete" title="Delete">\n            <i class="fas fa-trash-alt"></i>\n          </button>\n        </div>\n      </td>\n    '),t},bindDetailRowEvents:function(e,t){var r=e.querySelector(".action-btn.assign"),n=e.querySelector(".action-btn.return"),o=e.querySelector(".action-btn.delete");r&&r.addEventListener("click",(function(){window.openAssignFromCode(t.UniformCode)})),n&&n.addEventListener("click",(function(){window.returnUniformByCode(t.UniformCode)})),o&&o.addEventListener("click",(function(){console.log("🧨 Delete clicked (modal row):",t.UniformCode),window.confirmDeleteUniform(t.UniformCode)}))},renderPagination:function(e){var t=document.getElementById("pagination");if(t){t.innerHTML="";for(var r=Math.ceil(e/this.rowsPerPage),n=1;n<=r;n++){var o=this.createPaginationButton(n);t.appendChild(o)}}},createPaginationButton:function(e){var t=this,r=document.createElement("button");return r.textContent=e,r.className="pagination-btn",e===this.currentPage&&r.classList.add("active"),r.addEventListener("click",(0,o.A)(i().mark((function r(){var n;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.currentPage=e,r.next=3,T.fetchUniforms();case 3:return n=r.sent,r.next=6,t.renderUniformBaseCards(n);case 6:case"end":return r.stop()}}),r)})))),r},toggleModal:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=document.getElementById(e);r?t?r.classList.remove("hidden"):r.classList.add("hidden"):console.warn('Modal with ID "'.concat(e,'" not found.'))},prepareAssignForm:function(){["assignEmployeeId","assignEmployeeName","assignUniformCode"].forEach((function(e){var t=document.getElementById(e);t&&(t.value="")}))},resetModals:function(){var e=document.getElementById("codeForm");e&&e.reset();var t=document.getElementById("assignForm");t&&t.reset();var r=document.getElementById("codeListBody");r&&(r.innerHTML="")},previewImportData:function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},t="<tbody>".concat((arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(e){return"\n    <tr>\n      <td>".concat(e.UniformCode,"</td>\n      <td>").concat(e.EmployeeID,"</td>\n      <td>").concat(e.EmployeeName,"</td>\n      <td>").concat(e.UniformType,"</td>\n      <td>").concat(e.UniformSize,"</td>\n      <td>").concat(e.UniformColor,"</td>\n      <td>").concat(e.Status,"</td>\n    </tr>\n  ")})).join(""),"</tbody>");Swal.fire({title:"📥 Preview Import",html:'\n      <div class="preview-scroll">\n        <table class="preview-table">\n          '.concat("\n    <thead>\n      <tr>\n        <th>Code</th>\n        <th>ID</th>\n        <th>Name</th>\n        <th>Type</th>\n        <th>Size</th>\n        <th>Color</th>\n        <th>Status</th>\n      </tr>\n    </thead>","\n          ").concat(t,"\n        </table>\n      </div>\n    "),showCancelButton:!0,confirmButtonText:"Import",cancelButtonText:"Cancel"}).then((function(t){t.isConfirmed&&e()})),window.reloadUniformCards=(0,o.A)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Q.refreshAll();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("❌ Failed to reload uniforms:",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))}},V=r(453);function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function W(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return $(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var X=(0,l.rJ)(s.db,"InventoryDB"),Y=[],K=[],ee=new Set;function te(){return re.apply(this,arguments)}function re(){return(re=(0,o.A)(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,null===(t=Q.setFormLoading)||void 0===t||t.call(Q,!0),e.next=4,ie();case 4:return Q.renderUniformBaseCards(K),e.next=7,ne();case 7:n=void 0,a=void 0,c=void 0,u=void 0,(n=document.getElementById("searchByUniformAndEmployee"))&&n.addEventListener("input",(0,V.s)((function(e){var t=e.target.value.trim().toLowerCase();if(t&&Array.isArray(Y)){var r=Y.filter((function(e){var r,n,o;return(null===(r=e.UniformID)||void 0===r?void 0:r.toLowerCase().includes(t))||(null===(n=e.UniformCode)||void 0===n?void 0:n.toLowerCase().includes(t))||(null===(o=e.EmployeeName)||void 0===o?void 0:o.toLowerCase().includes(t))}));Q.renderInventoryCards(r)}else Q.renderInventoryCards(Y)}),300)),null===(a=document.getElementById("btnExportReport"))||void 0===a||a.addEventListener("click",(0,o.A)(i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.fetchAllForExport();case 2:t=e.sent,r=T.exportCSV(t,["UniformID","UniformCode","UniformType","UniformSize","UniformColor","UniformQty","EmployeeID","EmployeeName","EmployeeDepartment","Status","RewashCount"]),(n=document.createElement("a")).href=r,n.download="inventory_report.csv",n.click(),URL.revokeObjectURL(r);case 9:case"end":return e.stop()}}),e)})))),(c=document.getElementById("btnImportReport"))&&c.addEventListener("click",(function(){var e=document.createElement("input");e.type="file",e.accept=".csv",e.addEventListener("change",function(){var e=(0,o.A)(i().mark((function e(t){var r,n,a,c,u,s,l,d,f,p,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===(r=t.target.files)||void 0===r?void 0:r[0]){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,n.text();case 6:if(a=e.sent,c=T.parseCSV(a),Array.isArray(c)&&0!==c.length){e.next=10;break}return e.abrupt("return",Swal.fire({icon:"warning",title:"No data in the CSV file"}));case 10:return e.next=12,T.getAllEmployeesAsMap();case 12:return u=e.sent,e.next=15,T.getAllUniformsAsMap();case 15:s=e.sent,l=[],d=W(c);try{for(d.s();!(f=d.n()).done;)p=f.value,m=u[p.EmployeeID],v=s[p.UniformID],m&&v&&l.push({UniformID:v.uniformID||v.id||"",UniformCode:p.UniformCode,UniformType:v.uniformType||"",UniformSize:v.uniformSize||"",UniformColor:v.uniformColor||"",UniformQty:1,img:v.img||"",EmployeeID:m.employeeId,EmployeeName:m.employeeName,EmployeeDepartment:m.employeeDept,Status:"assigned",RewashCount:0})}catch(e){d.e(e)}finally{d.f()}if(0!==l.length){e.next=21;break}return e.abrupt("return",Swal.fire({icon:"warning",title:"Import Failed",text:"No valid data found"}));case 21:Q.previewImportData(l,(0,o.A)(i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0,r=l;case 1:if(!(t<r.length)){e.next=8;break}return n=r[t],e.next=5,T.assignUniformToEmployee(n);case 5:t++,e.next=1;break;case 8:return e.next=10,me();case 10:Swal.fire({icon:"success",title:"Import successful",timer:1500,showConfirmButton:!1});case 11:case"end":return e.stop()}}),e)})))),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(3),console.error("❌ CSV Import Error:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Unable to import data"});case 28:case"end":return e.stop()}}),e,null,[[3,24]])})));return function(t){return e.apply(this,arguments)}}()),e.click()})),(u=document.getElementById("assignForm"))&&u.addEventListener("submit",function(){var e=(0,o.A)(i().mark((function e(t){var r,n,o,a,c,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),o=null===(r=document.getElementById("assignEmployeeId"))||void 0===r?void 0:r.value.trim(),a=null===(n=document.getElementById("assignUniformCode"))||void 0===n?void 0:n.value.trim().toUpperCase(),o&&a){e.next=5;break}return e.abrupt("return",Swal.fire({icon:"warning",title:"Incomplete data"}));case 5:return e.prev=5,e.next=8,T.fetchEmployeeById(o);case 8:if(c=e.sent){e.next=11;break}return e.abrupt("return",Swal.fire({icon:"error",title:"Employee not found"}));case 11:return e.next=13,T.fetchUniformCodeByCode(a);case 13:if(u=e.sent){e.next=16;break}return e.abrupt("return",Swal.fire({icon:"error",title:"Uniform code not found"}));case 16:if("available"===u.Status){e.next=18;break}return e.abrupt("return",Swal.fire({icon:"warning",title:"This code is already assigned"}));case 18:return e.next=20,T.assignFromAvailableCode(a,{employeeId:c.employeeId,employeeName:c.employeeName,employeeDept:c.employeeDept});case 20:return Q.toggleModal("assignModal",!1),e.next=23,Q.reloadDetailModal(u.UniformID);case 23:return e.next=25,ye(a);case 25:Swal.fire({icon:"success",title:"Assignment successful",timer:1500,showConfirmButton:!1}),e.next=32;break;case 28:e.prev=28,e.t0=e.catch(5),console.error("❌ Assign Error:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message});case 32:case"end":return e.stop()}}),e,null,[[5,28]])})));return function(t){return e.apply(this,arguments)}}()),function(){var e=document.getElementById("codeForm");e&&e.addEventListener("submit",function(){var e=(0,o.A)(i().mark((function e(t){var r,n,o,a,c,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),o=null===(r=document.getElementById("addCodeUniformId"))||void 0===r?void 0:r.value,a=null===(n=document.getElementById("addUniformCode"))||void 0===n?void 0:n.value,c=null==a?void 0:a.trim().toUpperCase(),o&&c){e.next=6;break}return e.abrupt("return",Swal.fire({icon:"warning",title:"Incomplete data"}));case 6:if(!ee.has(c)){e.next=8;break}return e.abrupt("return",Swal.fire({icon:"warning",title:"Duplicate Code",text:"Please use a different code"}));case 8:return e.prev=8,e.next=11,T.fetchUniformById(o);case 11:if(u=e.sent){e.next=14;break}return e.abrupt("return",Swal.fire({icon:"error",title:"Uniform not found"}));case 14:return e.next=16,T.assignUniformToEmployee({UniformID:u.uniformID||u.id||"",UniformType:u.uniformType||"",UniformSize:u.uniformSize||"",UniformColor:u.uniformColor||"",UniformCode:c,UniformQty:u.qty||1,img:u.img||"",EmployeeID:"",EmployeeName:"",EmployeeDepartment:"",Status:"available",RewashCount:0});case 16:return Swal.fire({icon:"success",title:"Code added successfully",timer:1500,showConfirmButton:!1}),Q.toggleModal("codeModal",!1),e.next=20,Q.reloadDetailModal(u.uniformID);case 20:return e.next=22,ye(c);case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(8),console.error("❌ Add Code Error:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Unable to add the code"});case 28:case"end":return e.stop()}}),e,null,[[8,24]])})));return function(t){return e.apply(this,arguments)}}())}(),function(){var e=document.getElementById("assignEmployeeId"),t=document.getElementById("assignEmployeeName");if(e&&t){var r={};e.addEventListener("blur",(0,o.A)(i().mark((function n(){var o,a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.value.trim()){n.next=4;break}return t.value="",n.abrupt("return");case 4:if(!r[o]){n.next=7;break}return t.value=r[o].employeeName||"",n.abrupt("return");case 7:return n.prev=7,n.next=10,T.fetchEmployeeById(o);case 10:(a=n.sent)?(r[o]=a,t.value=a.employeeName||""):t.value="",n.next=18;break;case 14:n.prev=14,n.t0=n.catch(7),console.error("❌ AutoFill Error:",n.t0),t.value="";case 18:case"end":return n.stop()}}),n,null,[[7,14]])}))))}}(),window.updateCodeInline=function(){var e=(0,o.A)(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=t.textContent.trim().toUpperCase())&&n!==r.toUpperCase()){e.next=3;break}return e.abrupt("return");case 3:if(!ee.has(n)){e.next=7;break}return Swal.fire({icon:"warning",title:"This code is already in use",text:"Please use a different code"}),t.textContent=r,e.abrupt("return");case 7:return e.next=9,Swal.fire({title:"Confirm change of code?",text:"".concat(r," → ").concat(n),icon:"question",showCancelButton:!0,confirmButtonText:"Confirm"});case 9:if(e.sent.isConfirmed){e.next=13;break}return t.textContent=r,e.abrupt("return");case 13:return e.prev=13,e.next=16,T.updateUniformCode(r,{UniformCode:n});case 16:return ee.delete(r.toUpperCase()),ee.add(n),Swal.fire({icon:"success",title:"Code updated successfully",timer:1200,showConfirmButton:!1}),e.next=21,ye(code);case 21:e.next=28;break;case 23:e.prev=23,e.t0=e.catch(13),console.error("❌ Update Code Error:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Unable to update the code"}),t.textContent=r;case 28:case"end":return e.stop()}}),e,null,[[13,23]])})));return function(t,r){return e.apply(this,arguments)}}(),window.openAssignFromCode=(0,o.A)(i().mark((function e(){var t,r,n,o=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(o.length>0&&void 0!==o[0]?o[0]:"").trim().toUpperCase()){e.next=5;break}return Swal.fire({icon:"warning",title:"Invalid code"}),e.abrupt("return");case 5:return e.prev=5,e.next=8,T.fetchUniformCodeByCode(t);case 8:if((r=e.sent)&&"available"===r.Status){e.next=12;break}return Swal.fire({icon:"warning",title:"Code not found or already in use",text:t}),e.abrupt("return");case 12:Q.prepareAssignForm(r),(n=document.getElementById("assignUniformCode"))&&(n.value=r.UniformCode),Q.toggleModal("assignModal",!0),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(5),console.error("❌ openAssignFromCode Error:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Unable to open the Assign form"});case 23:case"end":return e.stop()}}),e,null,[[5,19]])}))),window.addEventListener("addCodeClick",ue),window.addEventListener("detailClick",le),window.addEventListener("importCodeClick",fe),window.addEventListener("beforeunload",(function(){var e;null===(e=Q.resetModals)||void 0===e||e.call(Q)})),window.closeBulkImportModal=function(){Q.toggleModal("bulkImportModal",!1)},e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("❌ InventoryPage Error:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Failed to load inventory data"});case 14:return e.prev=14,null===(r=Q.setFormLoading)||void 0===r||r.call(Q,!1),e.finish(14);case 17:case"end":return e.stop()}var n,a,c,u}),e,null,[[0,10,14,17]])})))).apply(this,arguments)}function ne(){return oe.apply(this,arguments)}function oe(){return(oe=(0,o.A)(i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=(0,l.P)(X,(0,l.My)("UniformCode"),(0,l.AB)(100)),e.next=4,(0,l.GG)(r);case 4:n=e.sent,Y=n.docs.map((function(e){return Z({id:e.id},e.data())})),ee=new Set(Y.map((function(e){return e.UniformCode}))),null===(t=Q.renderInventoryCards)||void 0===t||t.call(Q,Y),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("❌ Error loading inventory data: ",e.t0),Swal.fire({icon:"error",title:"Failed to load data",text:e.t0.message||"Could not load Inventory data"});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function ae(e){return ee.has(e)}function ie(){return ce.apply(this,arguments)}function ce(){return(ce=(0,o.A)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T.fetchUniforms();case 3:if(t=e.sent,Array.isArray(t)){e.next=8;break}return console.warn("⚠️ Uniform data is not an array:",t),K=[],e.abrupt("return");case 8:K=t,e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("❌ Failed to load uniforms:",e.t0),K=[];case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function ue(e){return se.apply(this,arguments)}function se(){return(se=(0,o.A)(i().mark((function e(t){var r,n,o,a,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null==t||null===(r=t.detail)||void 0===r?void 0:r.id){e.next=4;break}return Swal.fire({icon:"warning",title:"Uniform ID not found"}),e.abrupt("return");case 4:return e.prev=4,e.next=7,T.fetchUniformById(n);case 7:if(o=e.sent){e.next=10;break}return e.abrupt("return",Swal.fire({icon:"error",title:"Uniform data not found"}));case 10:a=document.getElementById("addCodeUniformId"),c=document.getElementById("addUniformCode"),a&&(a.value=o.uniformID||o.id||""),c&&(c.value=""),Q.toggleModal("codeModal",!0),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(4),console.error("❌ handleAddCodeClick Error:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Unable to open the add code form"});case 22:case"end":return e.stop()}}),e,null,[[4,18]])})))).apply(this,arguments)}function le(e){return de.apply(this,arguments)}function de(){return(de=(0,o.A)(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null==t||null===(r=t.detail)||void 0===r?void 0:r.id){e.next=4;break}return Swal.fire({icon:"warning",title:"ไม่พบรหัสยูนิฟอร์ม"}),e.abrupt("return");case 4:return e.prev=4,e.next=7,Q.reloadDetailModal(n);case 7:Q.toggleModal("codeListModal",!0),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),console.error("❌ handleDetailClick Error:",e.t0),Swal.fire({icon:"error",title:"ไม่สามารถโหลดรายละเอียดได้",text:e.t0.message||"เกิดข้อผิดพลาด"});case 14:case"end":return e.stop()}}),e,null,[[4,10]])})))).apply(this,arguments)}function fe(e){return pe.apply(this,arguments)}function pe(){return pe=(0,o.A)(i().mark((function e(t){var r,n,a,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null==t||null===(r=t.detail)||void 0===r?void 0:r.id){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,T.fetchUniformById(n);case 6:if(a=e.sent){e.next=9;break}return e.abrupt("return",Swal.fire({icon:"error",title:"Uniform data not found"}));case 9:(c=document.createElement("input")).type="file",c.accept=".csv",c.addEventListener("change",function(){var e=(0,o.A)(i().mark((function e(t){var r,n,o,c,u,s,l,d,f,p,m;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===(r=t.target.files)||void 0===r?void 0:r[0]){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,n.text();case 6:if(o=e.sent,c=T.parseCSV(o),0!==(u=c.map((function(e){var t;return null===(t=e.UniformCode)||void 0===t?void 0:t.trim().toUpperCase()})).filter((function(e){return!!e}))).length){e.next=11;break}return e.abrupt("return",Swal.fire({icon:"warning",title:"No data",text:"The file must contain at least one UniformCode column"}));case 11:return s=u.map((function(e){return"<tr><td>".concat(e,"</td></tr>")})).join(""),e.next=14,Swal.fire({title:"📥 Import Codes to ".concat(a.uniformID),html:' \n            <table border="1" style="width:100%;font-size:0.9rem">\n              <thead><tr><th>Code</th></tr></thead>\n              <tbody>'.concat(s,"</tbody>\n            </table>"),showCancelButton:!0,confirmButtonText:"Import"});case 14:if(e.sent.isConfirmed){e.next=17;break}return e.abrupt("return");case 17:l=0,d=0,f=W(u),e.prev=20,f.s();case 22:if((p=f.n()).done){e.next=33;break}if(m=p.value,!ee.has(m)){e.next=27;break}return d++,e.abrupt("continue",31);case 27:return e.next=29,T.assignUniformToEmployee({UniformID:a.uniformID,UniformType:a.uniformType,UniformSize:a.uniformSize,UniformColor:a.uniformColor,UniformQty:1,UniformCode:m,img:a.img||"",EmployeeID:"",EmployeeName:"",EmployeeDepartment:"",Status:"available",RewashCount:0});case 29:ee.add(m),l++;case 31:e.next=22;break;case 33:e.next=38;break;case 35:e.prev=35,e.t0=e.catch(20),f.e(e.t0);case 38:return e.prev=38,f.f(),e.finish(38);case 41:return e.next=43,Q.reloadDetailModal(a.uniformID);case 43:Swal.fire({icon:"success",title:"Import Complete",html:"✅ Imported: ".concat(l,"<br>⚠️ Duplicates skipped: ").concat(d)}),e.next=50;break;case 46:e.prev=46,e.t1=e.catch(3),console.error("❌ CSV Import Error:",e.t1),Swal.fire({icon:"error",title:"An error occurred",text:e.t1.message||"Unable to import data"});case 50:case"end":return e.stop()}}),e,null,[[3,46],[20,35,38,41]])})));return function(t){return e.apply(this,arguments)}}()),c.click(),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),console.error("❌ handleImportCodeClick Error:",e.t0),Swal.fire({icon:"error",title:"Unable to load data",text:e.t0.message||"An error occurred"});case 20:case"end":return e.stop()}}),e,null,[[3,16]])}))),pe.apply(this,arguments)}function me(){return ve.apply(this,arguments)}function ve(){return(ve=(0,o.A)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,K&&0!==K.length){e.next=4;break}return e.next=4,ie();case 4:return Q.renderUniformBaseCards(K),e.next=7,T.fetchInventoryItemsLimited(50);case 7:t=e.sent,Y=t,ee=new Set(t.map((function(e){return e.UniformCode}))),Q.renderInventoryCards(t),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("❌ Failed to reload inventory data:",e.t0),Swal.fire({icon:"error",title:"Failed to load data",text:e.t0.message||"Unable to reload data"});case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function ye(e){return he.apply(this,arguments)}function he(){return(he=(0,o.A)(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T.fetchUniformCodeByCode(t);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:(n=Y.findIndex((function(e){return e.UniformCode===t})))>=0?Y[n]=r:Y.unshift(r),ee.add(t),Q.replaceInventoryCard(r),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("❌ Failed to refresh item in view:",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}window.returnUniformByCode=(0,o.A)(i().mark((function e(){var t,r,n=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(n.length>0&&void 0!==n[0]?n[0]:"").trim().toUpperCase()){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,Swal.fire({title:"Return uniform?",text:"Are you sure you want to return code: ".concat(t,"?"),icon:"question",showCancelButton:!0,confirmButtonText:"Confirm"});case 6:if(e.sent.isConfirmed){e.next=9;break}return e.abrupt("return");case 9:return e.prev=9,e.next=12,T.returnUniform(t);case 12:return e.next=14,T.getUniformIdByCode(t);case 14:if(r=e.sent){e.next=17;break}return e.abrupt("return",Swal.fire({icon:"error",title:"UniformID not found"}));case 17:return e.next=19,Q.reloadDetailModal(r);case 19:Swal.fire({icon:"success",title:"Uniform returned successfully!",timer:1500,showConfirmButton:!1}),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(9),console.error("❌ RETURN ERROR:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Unable to return the uniform"});case 26:case"end":return e.stop()}}),e,null,[[9,22]])}))),window.confirmDeleteUniform=(0,o.A)(i().mark((function e(){var t,r,n=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(n.length>0&&void 0!==n[0]?n[0]:"").trim().toUpperCase()){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,Swal.fire({title:"Delete this item?",text:"Are you sure you want to delete code: ".concat(t,"?"),icon:"warning",showCancelButton:!0,confirmButtonText:"Confirm",cancelButtonText:"Cancel"});case 6:if(e.sent.isConfirmed){e.next=9;break}return e.abrupt("return");case 9:return e.prev=9,e.next=12,T.getUniformIdByCode(t);case 12:if(r=e.sent){e.next=15;break}return e.abrupt("return",Swal.fire({icon:"error",title:"UniformID not found"}));case 15:return e.next=17,T.deleteUniformEntry(t);case 17:return e.next=19,Q.reloadDetailModal(r);case 19:Swal.fire({icon:"success",title:"Code deleted successfully!",timer:1500,showConfirmButton:!1}),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(9),console.error("❌ DELETE ERROR:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Unable to delete this code"});case 26:case"end":return e.stop()}}),e,null,[[9,22]])}))),window.closeAssignModal=function(){return Q.toggleModal("assignModal",!1)},window.closeCodeListModal=function(){return Q.toggleModal("codeListModal",!1)},window.closeAddCodeModal=function(){return Q.toggleModal("codeModal",!1)},window.InventoryModel=T,window.syncAllEmployeeDataToInventory=(0,o.A)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R();case 3:return e.next=5,ne();case 5:Swal.fire({icon:"success",title:"Employee data updated in Inventory!",timer:2e3,showConfirmButton:!1}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("❌ Sync Error:",e.t0),Swal.fire({icon:"error",title:"Error during Sync",text:e.t0.message||"Unable to update data"});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))},453:(e,t,r)=>{function n(e,t){var r;return function(){for(var n=this,o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];clearTimeout(r),r=setTimeout((function(){return e.apply(n,a)}),t)}}function o(e){var t=document.getElementById(e);return t||console.warn("⚠️ Element #".concat(e," not found")),t}r.d(t,{s:()=>n,y:()=>o})},482:(e,t,r)=>{r.d(t,{db:()=>i});var n=r(223),o=r(594),a=(0,n.Wp)({apiKey:"AIzaSyAvJ4SgGaazPf6mY4G5-QfWcX2Yhkg-1X0",authDomain:"rd-wash-v2.firebaseapp.com",projectId:"rd-wash-v2",storageBucket:"rd-wash-v2.firebasestorage.app",messagingSenderId:"553662948172",appId:"1:553662948172:web:2423d7a81f2bbc9d53a5e9"}),i=(0,o.aU)(a)}}]);
//# sourceMappingURL=inventory.js.map