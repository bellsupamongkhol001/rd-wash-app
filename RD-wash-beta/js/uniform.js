"use strict";(self.webpackChunkrd_wash_001=self.webpackChunkrd_wash_001||[]).push([[897],{482:(e,r,t)=>{t.d(r,{db:()=>i});var n=t(223),o=t(594),a=(0,n.Wp)({apiKey:"AIzaSyAvJ4SgGaazPf6mY4G5-QfWcX2Yhkg-1X0",authDomain:"rd-wash-v2.firebaseapp.com",projectId:"rd-wash-v2",storageBucket:"rd-wash-v2.firebasestorage.app",messagingSenderId:"553662948172",appId:"1:553662948172:web:2423d7a81f2bbc9d53a5e9"}),i=(0,o.aU)(a)},917:(e,r,t)=>{t.r(r),t.d(r,{initUniformPage:()=>E});var n=t(458),o=t(467),a=t(756),i=t.n(a),c=t(980),u=t(284),s=t(482),l=t(594);function f(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?f(Object(t),!0).forEach((function(r){(0,c.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function m(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}var p="UniformsDB",v=(0,l.rJ)(s.db,p);function h(){return(h=(0,o.A)(i().mark((function e(){var r,t,n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=(0,l.P)(v,(0,l.My)("uniformID")),e.next=4,(0,l.GG)(r);case 4:return t=e.sent,e.abrupt("return",t.docs.map((function(e){return d({id:e.id},e.data())})));case 8:return e.prev=8,e.t0=e.catch(0),console.warn("⚠️ orderBy ล้มเหลว → fallback เป็น client-side sort",e.t0),e.next=13,(0,l.GG)(v);case 13:return n=e.sent,o=n.docs.map((function(e){return d({id:e.id},e.data())})),e.abrupt("return",o.sort((function(e,r){return(e.uniformID||"").localeCompare(r.uniformID||"")})));case 16:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function y(){return(y=(0,o.A)(i().mark((function e(r){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}throw new Error("⚠️ [fetchUniformById] ต้องระบุ Uniform ID");case 2:return e.prev=2,t=(0,l.H9)(s.db,p,r),e.next=6,(0,l.x7)(t);case 6:return n=e.sent,e.abrupt("return",n.exists()?d({id:n.id},n.data()):null);case 10:throw e.prev=10,e.t0=e.catch(2),console.error("❌ [fetchUniformById] ดึงข้อมูลล้มเหลว (ID: ".concat(r,")"),e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}function w(){return(w=(0,o.A)(i().mark((function e(r){var t,n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===(t=r.uniformID)||void 0===t?void 0:t.trim()){e.next=3;break}throw new Error("⚠️ [createUniform] ต้องระบุ Uniform ID");case 3:return e.prev=3,o=(0,l.H9)(s.db,p,n),e.next=7,(0,l.x7)(o);case 7:if(!e.sent.exists()){e.next=10;break}throw new Error("⚠️ ยูนิฟอร์มรหัส ".concat(n," มีอยู่แล้ว"));case 10:return e.next=12,(0,l.BN)(o,r);case 12:e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(3),console.error("❌ [createUniform] เพิ่มยูนิฟอร์มล้มเหลว (ID: ".concat(n,")"),e.t0),e.t0;case 18:case"end":return e.stop()}}),e,null,[[3,14]])})))).apply(this,arguments)}function b(){return(b=(0,o.A)(i().mark((function e(r,t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}throw new Error("⚠️ ต้องระบุ Uniform ID เพื่ออัปเดต");case 2:return e.prev=2,n=(0,l.H9)(s.db,p,r),e.next=6,(0,l.x7)(n);case 6:if(e.sent.exists()){e.next=9;break}throw new Error("❌ ไม่พบยูนิฟอร์มที่มี ID: ".concat(r));case 9:return e.next=11,(0,l.mZ)(n,t);case 11:e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(2),console.error("❌ [updateUniform] อัปเดตล้มเหลว (ID: ".concat(r,")"),e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[2,13]])})))).apply(this,arguments)}function g(){return(g=(0,o.A)(i().mark((function e(r){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}throw new Error("⚠️ กรุณาระบุ Uniform ID สำหรับการลบ");case 2:return e.prev=2,t=(0,l.H9)(s.db,p,r),e.next=6,(0,l.x7)(t);case 6:if(e.sent.exists()){e.next=9;break}throw new Error("❌ ไม่พบยูนิฟอร์มที่มี ID: ".concat(r));case 9:return e.next=11,(0,l.kd)(t);case 11:e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(2),console.error("❌ [deleteUniform] ลบไม่สำเร็จ (ID: ".concat(r,")"),e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[2,13]])})))).apply(this,arguments)}var x={fetchAllUniforms:function(){return h.apply(this,arguments)},fetchUniformById:function(e){return y.apply(this,arguments)},createUniform:function(e){return w.apply(this,arguments)},updateUniform:function(e,r){return b.apply(this,arguments)},deleteUniform:function(e){return g.apply(this,arguments)},parseCSV:function(e){var r=e.trim().split("\n"),t=r[0].split(",").map((function(e){return e.trim()}));return r.slice(1).map((function(e){var r=e.split(",").map((function(e){return e.trim()})),n={};return t.forEach((function(e,t){n[e]=r[t]})),n}))},exportCSV:function(e,r){if(!Array.isArray(r)||r.some((function(e){return"string"!=typeof e})))throw new Error("❌ Headers ต้องเป็น array ของ string เท่านั้น");var t,n=[r.join(",")],o=function(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return m(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?m(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw a}}}}(e);try{var a=function(){var e=t.value,o=r.map((function(r){var t;return'"'.concat(null!==(t=e[r])&&void 0!==t?t:"",'"')})).join(",");n.push(o)};for(o.s();!(t=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}},isValidUniform:function(e){if(!e||"object"!==(0,u.A)(e))return!1;var r=e.uniformID,t=e.uniformType,n=e.uniformSize,o=e.uniformColor,a=e.uniformQty,i=parseInt(null!=a?a:"0",10);return"string"==typeof r&&""!==r.trim()&&"string"==typeof t&&""!==t.trim()&&"string"==typeof n&&""!==n.trim()&&"string"==typeof o&&""!==o.trim()&&!isNaN(i)&&i>=0},toBase64:function(e){return new Promise((function(r,t){var n=new FileReader;n.onload=function(){return r(n.result)},n.onerror=function(e){return t(e)},n.readAsDataURL(e)}))}},S={currentPage:1,rowsPerPage:10,currentSortField:"employeeId",currentSortDirection:"asc",renderTable:function(e){var r=this,t=document.getElementById("uniformTableBody"),o=document.querySelector(".table-wrapper"),a=document.getElementById("loadingOverlay");if(t.innerHTML="",null==a||a.classList.add("hidden"),null==o||o.classList.remove("hidden"),!e||0===e.length)return t.innerHTML='<tr>\n      <td colspan="7" style="text-align:center;padding:20px;color:#888;">\n        🚫 No data found\n      </td>\n    </tr>',void this.renderPagination(0);var i=(0,n.A)(e).sort((function(e,t){var n=r.currentSortField,o="asc"===r.currentSortDirection?1:-1;return(e[n]||"").localeCompare(t[n]||"")*o})),c=(this.currentPage-1)*this.rowsPerPage;i.slice(c,c+this.rowsPerPage).forEach((function(e){var r,n,o=null!==(r=e.img)&&void 0!==r&&r.startsWith("data:image")||null!==(n=e.img)&&void 0!==n&&n.startsWith("http")?e.img:"https://cdn-icons-png.flaticon.com/512/892/892458.png",a=document.createElement("tr");a.innerHTML="\n      <td>".concat(e.uniformID,"</td>\n      <td>").concat(e.uniformType,"</td>\n      <td>").concat(e.uniformSize,"</td>\n      <td>").concat(e.uniformColor,"</td>\n      <td>").concat(e.uniformQty,'</td>\n      <td>\n        <img src="').concat(o,'" width="40" height="40" style="object-fit:cover;border-radius:8px;border:1px solid #ccc;" />\n      </td>\n      <td>\n        <button class="btn action-btn edit" data-id="').concat(e.uniformID,'" style="background:orange;color:#fff">\n          <i class="fas fa-edit"></i>\n        </button>\n        <button class="btn action-btn delete" data-id="').concat(e.uniformID,'" style="background:red;color:#fff">\n          <i class="fas fa-trash"></i>\n        </button>\n      </td>'),t.appendChild(a)})),document.querySelectorAll(".action-btn.edit").forEach((function(e){e.addEventListener("click",(function(){var r,t;return null===(r=(t=window).handleEditUniform)||void 0===r?void 0:r.call(t,e.dataset.id)}))})),document.querySelectorAll(".action-btn.delete").forEach((function(e){e.addEventListener("click",(function(){var r,t;return null===(r=(t=window).promptDeleteUniform)||void 0===r?void 0:r.call(t,e.dataset.id)}))})),this.renderPagination(e.length)},renderPagination:function(e){var r=this,t=document.getElementById("pagination");if(t){t.innerHTML="";for(var n=Math.ceil(e/this.rowsPerPage),o=function(e){var n=document.createElement("button");n.textContent=e,n.classList.add("pagination-btn"),e===r.currentPage&&n.classList.add("active"),n.onclick=function(){var t,n;r.currentPage=e,null===(t=(n=window).reloadUniformTable)||void 0===t||t.call(n)},t.appendChild(n)},a=1;a<=n;a++)o(a)}},resetForm:function(){["uniformID","uniformType","uniformSize","uniformColor","uniformQty","uniformPhoto"].forEach((function(e){var r=document.getElementById(e);r&&(r.value="")}));var e=document.getElementById("previewPhoto");e&&(e.src="",e.style.display="none");var r=document.getElementById("uniformID");r&&(r.disabled=!1)},toggleModal:function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=document.getElementById(e);t?t.classList.toggle("hidden",!r):console.warn('⚠️ toggleModal: ไม่พบ modal ที่มี id = "'.concat(e,'"'))},setModalTitle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Add Uniform",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fas fa-plus",t=document.querySelector("#uniformModal h3");t&&(t.innerHTML='<i class="'.concat(r,'"></i> ').concat(e))},setFormLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=document.querySelector(".btn-save");r&&(r.disabled=e,r.innerHTML=e?'<i class="fas fa-spinner fa-spin"></i> Saving...':'<i class="fas fa-save"></i> Save')},showPreviewImage:function(e){var r=document.getElementById("previewPhoto");if(!e||!r)return r.style.display="none";var t=new FileReader;t.onload=function(){r.src=t.result,r.style.display="block"},t.readAsDataURL(e)},initDropzone:function(){var e=this,r=document.getElementById("dropZone"),t=document.getElementById("uniformPhoto"),n=document.getElementById("previewPhoto");r&&t&&n&&(r.addEventListener("click",(function(){return t.click()})),r.addEventListener("dragover",(function(e){e.preventDefault(),r.classList.add("dragover")})),r.addEventListener("dragleave",(function(){r.classList.remove("dragover")})),r.addEventListener("drop",(function(n){n.preventDefault(),r.classList.remove("dragover");var o=n.dataTransfer.files[0];o&&o.type.startsWith("image/")&&(t.files=n.dataTransfer.files,e.showPreviewImage(o))})),t.addEventListener("change",(function(){var r=t.files[0];e.showPreviewImage(r)})))},showLoading:function(){var e,r;null===(e=document.querySelector(".table-wrapper"))||void 0===e||e.classList.add("hidden"),null===(r=document.getElementById("loadingOverlay"))||void 0===r||r.classList.remove("hidden")},hideLoading:function(){var e,r;null===(e=document.getElementById("loadingOverlay"))||void 0===e||e.classList.add("hidden"),null===(r=document.querySelector(".table-wrapper"))||void 0===r||r.classList.remove("hidden")},exportUniformsToCSV:function(e){var r=["uniformID","uniformType","uniformSize","uniformColor","uniformQty"],t=[r.join(",")].concat((0,n.A)(e.map((function(e){return r.map((function(r){return'"'.concat(e[r]||"",'"')})).join(",")})))).join("\n"),o=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(o),i=document.createElement("a");i.href=a,i.download="uniforms.csv",i.click(),URL.revokeObjectURL(a)}};function I(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return k(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?k(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw a}}}}function k(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}window.reloadUniformTable=(0,o.A)(i().mark((function e(){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,S.setFormLoading(!0),e.next=4,x.fetchAllUniforms();case 4:r=e.sent,S.renderTable(r),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("❌ reloadUniformTable error:",e.t0),Swal.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:e.t0.message||"ไม่สามารถโหลดข้อมูลยูนิฟอร์มได้"});case 12:return e.prev=12,S.setFormLoading(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,8,12,15]])})));var U=null;function E(){return A.apply(this,arguments)}function A(){return(A=(0,o.A)(i().mark((function e(){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,S.showLoading(!0),t=void 0,n=void 0,a=void 0,c=void 0,u=void 0,s=void 0,null===(t=document.querySelector(".btn-add"))||void 0===t||t.addEventListener("click",(0,o.A)(i().mark((function e(){var r,t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,U=null,S.resetForm(),S.setModalTitle("Add Uniform","fas fa-plus"),S.toggleModal("uniformModal",!0),S.initDropzone(),e.next=8,x.fetchAllUniforms();case 8:r=e.sent,t=B(r),(n=document.getElementById("uniformID"))&&(n.value=t,n.disabled=!0),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("❌ Error on Add Uniform:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Unable to open add uniform form",customClass:{popup:"swal-on-top"}});case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))),null===(n=document.querySelector("#cancelBtn"))||void 0===n||n.addEventListener("click",(function(){try{S.toggleModal("uniformModal",!1)}catch(e){console.error("❌ Error closing modal:",e),Swal.fire({icon:"error",title:"An error occurred",text:e.message||"Unable to close the window"})}})),null===(a=document.querySelector("#searchUniform"))||void 0===a||a.addEventListener("input",function(){var e=(0,o.A)(i().mark((function e(r){var t,n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.target.value.toLowerCase().trim(),e.next=4,x.fetchAllUniforms();case 4:n=e.sent,o=t?n.filter((function(e){var r,n,o,a;return(null===(r=e.uniformID)||void 0===r?void 0:r.toLowerCase().includes(t))||(null===(n=e.uniformType)||void 0===n?void 0:n.toLowerCase().includes(t))||(null===(o=e.uniformSize)||void 0===o?void 0:o.toLowerCase().includes(t))||(null===(a=e.uniformColor)||void 0===a?void 0:a.toLowerCase().includes(t))})):n,S.renderTable(o),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("❌ Search Uniform Error:",e.t0),Swal.fire({icon:"error",title:"An error occurred during search",text:e.t0.message||"Unable to search for uniforms"});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(r){return e.apply(this,arguments)}}()),null===(c=document.querySelector(".btn-import"))||void 0===c||c.addEventListener("click",(function(){var e=document.createElement("input");e.type="file",e.accept=".csv",e.addEventListener("change",function(){var e=(0,o.A)(i().mark((function e(r){var t,n,o,a,c,u,s,l,f,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,t.text();case 6:return n=e.sent,o=x.parseCSV(n),a=o.map((function(e){return"<tr>\n            <td>".concat(e.uniformID,"</td>\n            <td>").concat(e.uniformType,"</td>\n            <td>").concat(e.uniformSize,"</td>\n            <td>").concat(e.uniformColor,"</td>\n          </tr>")})).join(""),e.next=11,Swal.fire({title:"Preview Import",html:'<table border="1" style="width:100%;font-size:0.9rem">\n                  <thead><tr><th>ID </th><th>Type</th><th>Size</th><th>Color</th></tr></thead>\n                  <tbody>'.concat(a,"</tbody>\n                </table>"),showCancelButton:!0,confirmButtonText:"Import Now",cancelButtonText:"Cancel",width:600,buttonsStyling:!0,customClass:{confirmButton:"swal2-confirm btn-success",cancelButton:"swal2-cancel btn-danger"}});case 11:if(e.sent.isConfirmed){e.next=14;break}return e.abrupt("return");case 14:c=0,u=0,s=I(o),e.prev=17,s.s();case 19:if((l=s.n()).done){e.next=35;break}if(f=l.value,!x.isValidUniform(f)){e.next=33;break}return e.next=24,x.fetchUniformById(f.uniformID);case 24:if(!e.sent){e.next=28;break}return u++,e.abrupt("continue",33);case 28:return f.uniformQty=parseInt(f.uniformQty||"0"),f.img="",e.next=32,x.createUniform(f);case 32:c++;case 33:e.next=19;break;case 35:e.next=40;break;case 37:e.prev=37,e.t0=e.catch(17),s.e(e.t0);case 40:return e.prev=40,s.f(),e.finish(40);case 43:return d="✅ Imported ".concat(c," items successfully"),u>0&&(d+="\n⚠️ Skipped ".concat(u," duplicate items")),Swal.fire({icon:"success",title:"Import Result",text:d,confirmButtonText:"Close"}),e.next=48,D();case 48:e.next=54;break;case 50:e.prev=50,e.t1=e.catch(3),console.error("❌ CSV Import Error:",e.t1),Swal.fire({icon:"error",title:"An error occurred",text:e.t1.message||"Unable to import data"});case 54:case"end":return e.stop()}}),e,null,[[3,50],[17,37,40,43]])})));return function(r){return e.apply(this,arguments)}}()),e.click()})),null===(u=document.querySelector(".btn-export"))||void 0===u||u.addEventListener("click",(0,o.A)(i().mark((function e(){var r,t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,S.setFormLoading(!0),e.next=4,x.fetchAllUniforms();case 4:if((r=e.sent)&&0!==r.length){e.next=7;break}return e.abrupt("return",Swal.fire({icon:"info",title:"No Uniform Data",text:"No data available for export"}));case 7:return e.next=9,Swal.fire({title:"Do you want to export uniform data?",icon:"question",showCancelButton:!0,confirmButtonText:"Export",cancelButtonText:"Cancel",buttonsStyling:!0,customClass:{confirmButton:"swal2-confirm btn-success",cancelButton:"swal2-cancel btn-danger"}});case 9:e.sent.isConfirmed&&(t=x.exportCSV(r,["uniformID","uniformType","uniformSize","uniformColor","uniformQty"]),(n=document.createElement("a")).href=t,n.download="uniforms.csv",n.click(),URL.revokeObjectURL(t),Swal.fire({icon:"success",title:"Export successful",text:"Total of ".concat(r.length," items exported"),timer:500,showConfirmButton:!1})),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("❌ Export Uniform Error:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Unable to export data"});case 17:return e.prev=17,S.setFormLoading(!1),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,13,17,20]])})))),null===(s=document.querySelector("#uniformForm"))||void 0===s||s.addEventListener("submit",function(){var e=(0,o.A)(i().mark((function e(r){var t,n,o,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),n=r.target,o=null===(t=document.getElementById("uniformPhoto"))||void 0===t?void 0:t.files[0],a={uniformID:n.uniformID.value.trim(),uniformType:n.uniformType.value.trim(),uniformSize:n.uniformSize.value.trim(),uniformColor:n.uniformColor.value.trim(),uniformQty:parseInt(n.uniformQty.value||"0"),img:""},x.isValidUniform(a)){e.next=6;break}return e.abrupt("return",Swal.fire({icon:"warning",title:"Please fill out all fields",timer:500,showConfirmButton:!1}));case 6:if(S.setFormLoading(!0),e.prev=7,!o){e.next=12;break}return e.next=11,x.toBase64(o);case 11:a.img=e.sent;case 12:if(!U){e.next=17;break}return e.next=15,x.updateUniform(U,a);case 15:e.next=19;break;case 17:return e.next=19,x.createUniform(a);case 19:return e.next=21,D();case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(7),console.error(e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Unable to save data"});case 27:return e.prev=27,S.setFormLoading(!1),e.finish(27);case 30:case"end":return e.stop()}}),e,null,[[7,23,27,30]])})));return function(r){return e.apply(this,arguments)}}()),e.next=5,x.fetchAllUniforms();case 5:r=e.sent,S.renderTable(r),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("❌ UniformPage Error:",error),Swal.fire({icon:"error",title:"❌ Failed to load data",text:error.message||"An error occurred while loading data"});case 13:return e.prev=13,S.hideLoading(!1),e.finish(13);case 16:case"end":return e.stop()}var t,n,a,c,u,s}),e,null,[[0,9,13,16]])})))).apply(this,arguments)}function D(){return L.apply(this,arguments)}function L(){return(L=(0,o.A)(i().mark((function e(){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.fetchAllUniforms();case 3:r=e.sent,S.renderTable(r),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("❌ reloadTable error:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Unable to load uniform data"});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r="RD-Uniform-";try{var t=e.map((function(e){var t;return parseInt((null===(t=e.uniformID)||void 0===t?void 0:t.replace(r,""))||"0")})).filter((function(e){return!isNaN(e)})),o=((t.length>0?Math.max.apply(Math,(0,n.A)(t)):0)+1).toString().padStart(3,"0");return"".concat(r).concat(o)}catch(e){return console.error("❌ generateUniformID error:",e),"".concat(r,"001")}}window.reloadUniformTable=D,window.handleEditUniform=function(){var e=(0,o.A)(i().mark((function e(r){var t,n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.fetchUniformById(r);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return",Swal.fire({icon:"warning",title:"Data not found",text:"Uniform with ID: ".concat(r," not found")}));case 6:U=r,(n=document.querySelector("#uniformForm")).uniformID.value=t.uniformID,n.uniformID.disabled=!0,n.uniformType.value=t.uniformType,n.uniformSize.value=t.uniformSize,n.uniformColor.value=t.uniformColor,n.uniformQty.value=t.uniformQty||0,o=document.getElementById("previewPhoto"),t.img?(o.src=t.img,o.style.display="block"):(o.src="",o.style.display="none"),S.setModalTitle("Edit Uniform","fas fa-edit"),S.toggleModal("uniformModal",!0),S.initDropzone(),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(0),console.error("❌ Edit error:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Unable to load uniform data"});case 25:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(r){return e.apply(this,arguments)}}(),window.promptDeleteUniform=function(){var e=(0,o.A)(i().mark((function e(r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Swal.fire({title:"Delete data?",text:"Are you sure you want to delete this item?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete",cancelButtonText:"Cancel",buttonsStyling:!0,customClass:{confirmButton:"swal2-confirm btn-success",cancelButton:"swal2-cancel btn-danger"}});case 3:if(!e.sent.isConfirmed){e.next=10;break}return e.next=7,x.deleteUniform(r);case 7:return e.next=9,D();case 9:Swal.fire({icon:"success",title:"Deleted successfully",timer:500,showConfirmButton:!1});case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("❌ Delete Uniform Error:",e.t0),Swal.fire({icon:"error",title:"An error occurred",text:e.t0.message||"Unable to delete data"});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(r){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=uniform.js.map